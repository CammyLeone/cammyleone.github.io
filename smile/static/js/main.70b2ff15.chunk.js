(this["webpackJsonpsmile-client"]=this["webpackJsonpsmile-client"]||[]).push([[0],{19:function(e,n){e.exports=Buttplug},30:function(e,n,t){e.exports=t(51)},42:function(e,n){},43:function(e,n){},44:function(e,n){},51:function(e,n,t){"use strict";t.r(n);var r=t(2),c=t.n(r),a=t(24),o=t.n(a),i=t(29),u=t(3),s=t.n(u),l=t(7),d=t(5),f=t(6);function p(){return m.apply(this,arguments)}function m(){return(m=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.e.tinyFaceDetector.loadFromUri("/smile/models");case 2:return e.next=4,f.e.faceLandmark68Net.loadFromUri("/smile/models");case 4:return e.next=6,f.e.faceRecognitionNet.loadFromUri("/smile/models");case 6:return e.next=8,f.e.faceExpressionNet.loadFromUri("/smile/models");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return h.apply(this,arguments)}function h(){return(h=Object(l.a)(s.a.mark((function e(n){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.b(n,new f.a).withFaceLandmarks().withFaceExpressions();case 2:return t=e.sent,e.abrupt("return",t.length?t:null);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b=t(19);var g=function(e){var n=e.initiateConnection;return c.a.createElement("button",{onClick:n},"Connect a Toy")},w=function(e){var n=e.stopConnecting;return c.a.createElement("button",{onClick:n},"Stop Connecting")},x=function(){return c.a.createElement("span",null,"Connected!")},E=function(){return c.a.createElement("span",null,"Use Chrome to connect a toy.")};function j(e){var n=e.clickToStart,t=void 0===n?g:n,c=e.clickToStop,a=void 0===c?w:c,o=e.connected,i=void 0===o?x:o,u=e.unsupportedBrowser,f=void 0===u?E:u,p=e.onNewDevice,m=Object(r.useState)(!1),v=Object(d.a)(m,2),h=v[0],j=v[1],O=Object(r.useState)(!1),C=Object(d.a)(O,2),y=C[0],k=C[1];return function(e,n){var t=Object(r.useRef)(null),c=Object(r.useState)([]),a=Object(d.a)(c,2),o=a[0],i=a[1],u=Object(r.useState)(!1),f=Object(d.a)(u,2),p=f[0],m=f[1];Object(r.useEffect)((function(){function r(){return(r=Object(l.a)(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new b.ButtplugEmbeddedClientConnector,e.next=4,t.current.Connect(n);case 4:e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return");case 10:return e.next=12,t.current.StartScanning();case 12:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}t.current&&!e&&(t.current=null),!t.current&&e&&(t.current=new b.ButtplugClient("Cammy"),t.current.addListener("deviceadded",(function(e){i(e),m(!0),n(e)})),function(){r.apply(this,arguments)}())}),[e])}(h,(function(e){k(!0),p(e)})),window.Bluetooth?y?i():h?h?a({stopConnecting:function(){return j(!1)}}):null:t({initiateConnection:function(){return j(!0)}}):f()}var O,C=t(25),y=t.n(C),k=t(8),S=t(9),F=function(e){var n=Object.keys(e).sort((function(n,t){return e[t]-e[n]}))[0];return{expression:n,confidence:e[n]}},B=Object(S.b)((function(e){var n=e.expression,t=e.confidence,r=e.className;return c.a.createElement("div",{className:r},c.a.createElement("h1",null,n),c.a.createElement("h1",null,t?"confidence: ".concat(t):""))}))(O||(O=Object(k.a)(["\n  display: flex;\n  flex-direction: row;\n  width: 100%;\n  place-content: space-between;\n"]))),N=function(e){var n=e.expressions;if(!n)return c.a.createElement(B,{expression:"Nothing detected"});var t=F(n),r=t.expression,a=t.confidence;return c.a.createElement(B,{expression:r,confidence:Math.round(100*a)/100})},V=function(e){var n=e.device,t=e.expressions;return function(e,n){Object(r.useEffect)((function(){function t(){return(t=Object(l.a)(s.a.mark((function n(){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("stopVibrate()"),n.next=3,e.SendStopDeviceCmd();case 3:console.log("stopVibrate() over");case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}e&&(console.log("vibrateEffect: ".concat(n)),n>0?(console.log("startVibrate()"),e.SendVibrateCmd(n),console.log("startVibrate() over")):function(){t.apply(this,arguments)}())}),[e,n])}(n,"happy"===(t&&F(t).expression)?1:0),null};function T(e){var n=e.detections,t=e.video,c=e.canvasEl;return Object(r.useEffect)((function(){if(n&&c){var e={width:t.width,height:t.height};f.d(t,e);var r=f.f(n,e);c.getContext("2d").clearRect(0,0,c.width,c.height),f.c.drawDetections(c,r)}}),[n,t,c]),null}var D,R,U,A,M,z=function(e){var n=e.device,t=e.video,a=e.resultsEl,o=Object(r.useState)(null),i=Object(d.a)(o,2),u=i[0],f=i[1],p=u&&u.length?u[0].expressions:null,m=function(){var e=Object(l.a)(s.a.mark((function e(){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(){return window.requestAnimationFrame(m)},e.next=3,v(t);case 3:r=e.sent,f(r),n();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){m()}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement(N,{expressions:p}),c.a.createElement(V,{device:n,expressions:p}),c.a.createElement(T,{detections:u,video:t,canvasEl:a}))},H=(t(47),Object(S.a)(D||(D=Object(k.a)(['\n  html,\n  body {\n    min-height: 100vh;\n    padding: 0;\n    margin: 0;\n    font-size: 20px;\n    font-family: "Sigmar One";\n    background-color: #FFF28C;\n    color: #000;\n  }\n'])))),L=S.b.div(R||(R=Object(k.a)(["\n  height: 100vh;\n\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n"]))),I=S.b.div(U||(U=Object(k.a)(["\n  padding: 2rem;\n  border: 2px solid #ec6e44;\n  border-radius: 10px 30px;\n  margin-bottom: 1rem;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n  &:hover {\n    background-color: #f6c8c7;\n  }\n"]))),J=S.b.svg(A||(A=Object(k.a)(["\n  width: 2rem;\n  height: 2rem;\n  padding-right: 1rem;\n"]))),W=function(e){var n=e.color;return c.a.createElement(J,{xmlns:"http://www.w3.org/2000/svg",viewBox:"20 12.5 60 75"},c.a.createElement("title",null,"Buttplug"),c.a.createElement("path",{stroke:n,fill:n,d:"M70,46c0-9.94-12.9-28-20-28S30,36.06,30,46A20,20,0,0,0,46,65.6V74H34v8H66V74H54V65.6A20,20,0,0,0,70,46ZM38,46c0-6.44,8.6-17.64,12-19.79C53.4,28.36,62,39.56,62,46a12,12,0,0,1-24,0Z"}))};S.b.div(M||(M=Object(k.a)(["\n  padding: 1rem;\n  box-shadow: 8px 0px 7px 5px rgb(0 0 0 / 25%), 0 10px 10px rgb(0 0 0 / 22%);\n"])));function Z(){var e=Object(r.useState)(!1),n=Object(d.a)(e,2),t=n[0],a=n[1],o=Object(r.useState)(!1),i=Object(d.a)(o,2),u=i[0],f=i[1],m=Object(r.useState)(null),v=Object(d.a)(m,2),h=v[0],b=v[1],g=Object(r.useRef)(null),w=Object(r.useRef)(null),x=t&&g.current&&w.current&&h;return Object(r.useEffect)((function(){(function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:a(!0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),console.log({faceApiInitialized:t,device:h,webcam:g}),c.a.createElement(L,null,c.a.createElement(H,null),c.a.createElement("div",{style:{position:"relative"}},c.a.createElement(y.a,{ref:g,videoConstraints:{width:1280,height:720},width:1280,height:720}),c.a.createElement("canvas",{style:{position:"absolute",top:"0",left:"0"},ref:w,width:g.current?g.current.video.width:0,height:g.current?g.current.video.height:0})),!x&&!u&&c.a.createElement(c.a.Fragment,null,c.a.createElement("h1",null,t?"ready":"initializing..."),c.a.createElement(j,{onNewDevice:b,clickToStart:function(e){var n=e.initiateConnection;return c.a.createElement(I,{onClick:n},c.a.createElement(W,{color:"#EC6E44"}),"Connect Your Toy")},clickToStop:function(e){var n=e.stopConnecting;return c.a.createElement(I,{onClick:n},"Stop Connecting")},connected:function(){return c.a.createElement(I,{disabled:!0},"Connected")},unsupportedBrowser:function(){return c.a.createElement(I,{disabled:!0},"Connect a Toy in Chrome")}})),x&&!u&&c.a.createElement(I,{onClick:function(){return f(!0)}},"Begin"),x&&u&&c.a.createElement(z,{device:h,video:g.current.video,resultsEl:w.current}))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(i.a,null,c.a.createElement(Z,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[30,1,2]]]);
//# sourceMappingURL=main.70b2ff15.chunk.js.map